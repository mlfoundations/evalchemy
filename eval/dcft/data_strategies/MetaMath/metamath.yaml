output_ids: ["remove_columns"]
operators:
  - id: generate_backwards_questions
    config:
      type: function
      function: data_strategies.MetaMath.utils.generate_backwards_questions
  - id: generate_input_examples
    config:
      type: function
      function: data_strategies.MetaMath.utils.generate_input_examples
  - id: rephrase_questions
    config:
      type: function
      sharded: true
      function: data_strategies.MetaMath.utils.rephrase_questions
    input_ids:
      - generate_input_examples
  - id: generate_forward_questions
    config:
      type: function
      sharded: true
      function: data_strategies.MetaMath.utils.generate_forward_questions
    input_ids:
      - generate_input_examples
      - rephrase_questions
  - id: rename_columns_forward_answer
    config:
      type: rename_column
      sharded: true
      input_column_name: pred_answer
      output_column_name: completion
    input_ids:
      - generate_forward_questions
  - id: rename_columns_forward_question
    config:
      type: rename_column
      sharded: true
      input_column_name: question
      output_column_name: prompt
    input_ids:
      - rename_columns_forward_answer
  - id: rename_columns_backwards_answer
    config:
      type: rename_column
      sharded: true
      input_column_name: inv_question_pred_answer
      output_column_name: completion
    input_ids:
      - backwards_reason_fobar
      - backwards_reason_sv
  - id: rename_columns_backwards_question
    config:
      type: rename_column
      sharded: true
      input_column_name: backwards_question
      output_column_name: prompt
    input_ids:
      - rename_columns_backwards_answer
  - id: self_verify
    config:
      type: function
      sharded: true
      function: data_strategies.MetaMath.utils.self_verify
    input_ids:
      - generate_backwards_questions
  - id: backwards_reason_sv
    config:
      type: function
      function: data_strategies.MetaMath.utils.backwards_reason
      input_dataset_map:
        inv_q_dataset: self_verify
        original_dataset: generate_input_examples
      function_config:
        method_name: SV
    input_ids:
      - self_verify
      - generate_input_examples
  - id: backwards_reason_fobar
    config:
      type: function
      function: data_strategies.MetaMath.utils.backwards_reason
      input_dataset_map:
        inv_q_dataset: generate_backwards_questions
        original_dataset: generate_input_examples
      function_config:
        method_name: fobar
    input_ids:
      - generate_backwards_questions
      - generate_input_examples
  - id: remove_columns
    config: 
      type: remove_columns
      sharded: true
      columns_to_keep:
        - prompt
        - completion
    input_ids:
      - rename_columns_backwards_question
      - rename_columns_forward_question